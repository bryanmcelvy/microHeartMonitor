<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>uHeartMonitor: An ECG-based Heart Rate Monitor: QRS Detector</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">uHeartMonitor: An ECG-based Heart Rate Monitor
   </div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__qrs.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">QRS Detector<div class="ingroups"><a class="el" href="group__app.html">Application Software</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Module for analyzing ECG data to determine heart rate.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for QRS Detector:</div>
<div class="dyncontent">
<div class="center"><img src="group__qrs.png" border="0" usemap="#agroup____qrs" alt=""/></div>
<map name="agroup____qrs" id="agroup____qrs">
<area shape="rect" href="group__app.html" title="Application&#45;specific software modules." alt="" coords="5,5,147,31"/>
<area shape="rect" title="Module for analyzing ECG data to determine heart rate." alt="" coords="195,5,299,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:_q_r_s_8c" id="r__q_r_s_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_q_r_s_8c.html">QRS.c</a></td></tr>
<tr class="memdesc:_q_r_s_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Source code for QRS detection module. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:_q_r_s_8h" id="r__q_r_s_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_q_r_s_8h.html">QRS.h</a></td></tr>
<tr class="memdesc:_q_r_s_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Header file for QRS detection module. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga06d3ab858cf424a90bdec4de1e7fb2db" id="r_ga06d3ab858cf424a90bdec4de1e7fb2db"><td class="memItemLeft" align="right" valign="top"><a id="ga06d3ab858cf424a90bdec4de1e7fb2db" name="ga06d3ab858cf424a90bdec4de1e7fb2db"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QRS_NUM_FID_MARKS</b>&#160;&#160;&#160;40</td></tr>
<tr class="separator:ga06d3ab858cf424a90bdec4de1e7fb2db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad93f0e49ce14743a04bba54e0a93791a" id="r_gad93f0e49ce14743a04bba54e0a93791a"><td class="memItemLeft" align="right" valign="top"><a id="gad93f0e49ce14743a04bba54e0a93791a" name="gad93f0e49ce14743a04bba54e0a93791a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>FLOAT_COMPARE_TOLERANCE</b>&#160;&#160;&#160;(float32_t)(1E-5f)</td></tr>
<tr class="separator:gad93f0e49ce14743a04bba54e0a93791a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacf320bd9c50a335acc2fe8591331e40e" id="r_gacf320bd9c50a335acc2fe8591331e40e"><td class="memItemLeft" align="right" valign="top"><a id="gacf320bd9c50a335acc2fe8591331e40e" name="gacf320bd9c50a335acc2fe8591331e40e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IS_GREATER</b>(X,  Y)&#160;&#160;&#160;(bool) ((X - Y) &gt; FLOAT_COMPARE_TOLERANCE)</td></tr>
<tr class="separator:gacf320bd9c50a335acc2fe8591331e40e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab356d160751a04b5b13c1286070a6a74" id="r_gab356d160751a04b5b13c1286070a6a74"><td class="memItemLeft" align="right" valign="top"><a id="gab356d160751a04b5b13c1286070a6a74" name="gab356d160751a04b5b13c1286070a6a74"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>IS_PEAK</b>(X_MINUS_1,  X,  X_PLUS_1)&#160;&#160;&#160;(bool) (IS_GREATER(X, X_MINUS_1) &amp;&amp; IS_GREATER(X, X_PLUS_1))</td></tr>
<tr class="separator:gab356d160751a04b5b13c1286070a6a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8897fc681e7d799ace372966481c1c78" id="r_ga8897fc681e7d799ace372966481c1c78"><td class="memItemLeft" align="right" valign="top"><a id="ga8897fc681e7d799ace372966481c1c78" name="ga8897fc681e7d799ace372966481c1c78"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QRS_SAMP_FREQ</b>&#160;&#160;&#160;((uint32_t) 200)</td></tr>
<tr class="separator:ga8897fc681e7d799ace372966481c1c78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78d4256603e5ab9cb95aa17964da9705" id="r_ga78d4256603e5ab9cb95aa17964da9705"><td class="memItemLeft" align="right" valign="top"><a id="ga78d4256603e5ab9cb95aa17964da9705" name="ga78d4256603e5ab9cb95aa17964da9705"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QRS_SAMP_PERIOD_SEC</b>&#160;&#160;&#160;((float32_t) 0.005f)</td></tr>
<tr class="separator:ga78d4256603e5ab9cb95aa17964da9705"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga495aa2eb7020c5abefeab4b4bb502e3e" id="r_ga495aa2eb7020c5abefeab4b4bb502e3e"><td class="memItemLeft" align="right" valign="top"><a id="ga495aa2eb7020c5abefeab4b4bb502e3e" name="ga495aa2eb7020c5abefeab4b4bb502e3e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QRS_NUM_SAMP</b>&#160;&#160;&#160;((uint16_t) (1 &lt;&lt; 11))</td></tr>
<tr class="separator:ga495aa2eb7020c5abefeab4b4bb502e3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga396b5235bf6e7bad06cee2fb528c0f54" id="r_ga396b5235bf6e7bad06cee2fb528c0f54"><td class="memItemLeft" ><a id="ga396b5235bf6e7bad06cee2fb528c0f54" name="ga396b5235bf6e7bad06cee2fb528c0f54"></a>
struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ff770b58cc997015befad1418e3d316" id="r_ga3ff770b58cc997015befad1418e3d316"><td class="memItemLeft" >
&#160;&#160;&#160;bool&#160;&#160;&#160;<b>isCalibrated</b>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:ga3ff770b58cc997015befad1418e3d316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2560a6c23055f6bd47dfe6bc678979c1" id="r_ga2560a6c23055f6bd47dfe6bc678979c1"><td class="memItemLeft" >
&#160;&#160;&#160;float32_t&#160;&#160;&#160;<b>signalLevel</b>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memdesc:ga2560a6c23055f6bd47dfe6bc678979c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">estimated signal level <br /></td></tr>
<tr class="separator:ga2560a6c23055f6bd47dfe6bc678979c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1add6afe9de1e88a40cb8a24c4d466b1" id="r_ga1add6afe9de1e88a40cb8a24c4d466b1"><td class="memItemLeft" >
&#160;&#160;&#160;float32_t&#160;&#160;&#160;<b>noiseLevel</b>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memdesc:ga1add6afe9de1e88a40cb8a24c4d466b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">estimated noise level <br /></td></tr>
<tr class="separator:ga1add6afe9de1e88a40cb8a24c4d466b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafc52cf7bafd0bc466c4772cae8ae9cd2" id="r_gafc52cf7bafd0bc466c4772cae8ae9cd2"><td class="memItemLeft" >
&#160;&#160;&#160;float32_t&#160;&#160;&#160;<b>threshold</b>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memdesc:gafc52cf7bafd0bc466c4772cae8ae9cd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">amplitude threshold <br /></td></tr>
<tr class="separator:gafc52cf7bafd0bc466c4772cae8ae9cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1ef5d0af26471a87d9b182e389efdeeb" id="r_ga1ef5d0af26471a87d9b182e389efdeeb"><td class="memItemLeft" >
&#160;&#160;&#160;uint16_t&#160;&#160;&#160;<b>fidMarkArray</b> [QRS_NUM_FID_MARKS]&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:ga1ef5d0af26471a87d9b182e389efdeeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8800defb2475c8837871fd62b69c028f" id="r_ga8800defb2475c8837871fd62b69c028f"><td class="memItemLeft" >
&#160;&#160;&#160;float32_t&#160;&#160;&#160;<b>utilityBuffer1</b> [QRS_NUM_FID_MARKS]&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memdesc:ga8800defb2475c8837871fd62b69c028f"><td class="mdescLeft">&#160;</td><td class="mdescRight">array to hold fidMark indices <br /></td></tr>
<tr class="separator:ga8800defb2475c8837871fd62b69c028f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac260ce936b14dfd3c93cc00cedf39f10" id="r_gac260ce936b14dfd3c93cc00cedf39f10"><td class="memItemLeft" >
&#160;&#160;&#160;float32_t&#160;&#160;&#160;<b>utilityBuffer2</b> [QRS_NUM_FID_MARKS]&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:gac260ce936b14dfd3c93cc00cedf39f10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga396b5235bf6e7bad06cee2fb528c0f54" id="r_ga396b5235bf6e7bad06cee2fb528c0f54"><td class="memItemLeft" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><b>Detector</b> = { false, 0.0f, 0.0f, 0.0f, { 0 }, { 0 }, { 0 } }&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:ga396b5235bf6e7bad06cee2fb528c0f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Digital Filters</h2></td></tr>
<tr class="memitem:gabc6126af1d45847bc59afa0aa3216b04" id="r_gabc6126af1d45847bc59afa0aa3216b04"><td class="memItemLeft" align="right" valign="top"><a id="gabc6126af1d45847bc59afa0aa3216b04" name="gabc6126af1d45847bc59afa0aa3216b04"></a>enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<b>NUM_STAGES_BANDPASS</b> = 4
, <b>NUM_COEFF_HIGHPASS</b> = NUM_STAGES_BANDPASS * 5
, <b>STATE_BUFF_SIZE_BANDPASS</b> = NUM_STAGES_BANDPASS * 4
, <b>NUM_COEFF_DERFILT</b> = 5
, <br />
&#160;&#160;<b>BLOCK_SIZE_DERFILT</b> = (1 &lt;&lt; 8)
, <b>STATE_BUFF_SIZE_DERFILT</b> = NUM_COEFF_DERFILT + BLOCK_SIZE_DERFILT - 1
, <b>NUM_COEFF_MOVAVG</b> = 10
, <b>BLOCK_SIZE_MOVAVG</b> = BLOCK_SIZE_DERFILT
, <br />
&#160;&#160;<b>STATE_BUFF_SIZE_MOVAVG</b> = NUM_COEFF_MOVAVG + BLOCK_SIZE_MOVAVG - 1
<br />
 }</td></tr>
<tr class="separator:gabc6126af1d45847bc59afa0aa3216b04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga70063441c7f7c0cf6f11bcdd9c284e41" id="r_ga70063441c7f7c0cf6f11bcdd9c284e41"><td class="memItemLeft" align="right" valign="top"><a id="ga70063441c7f7c0cf6f11bcdd9c284e41" name="ga70063441c7f7c0cf6f11bcdd9c284e41"></a>
typedef arm_biquad_casd_df1_inst_f32&#160;</td><td class="memItemRight" valign="bottom"><b>IIR_Filt_t</b></td></tr>
<tr class="separator:ga70063441c7f7c0cf6f11bcdd9c284e41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga194c44a95aeb188161636e7eb78a1032" id="r_ga194c44a95aeb188161636e7eb78a1032"><td class="memItemLeft" align="right" valign="top"><a id="ga194c44a95aeb188161636e7eb78a1032" name="ga194c44a95aeb188161636e7eb78a1032"></a>
typedef arm_fir_instance_f32&#160;</td><td class="memItemRight" valign="bottom"><b>FIR_Filt_t</b></td></tr>
<tr class="separator:ga194c44a95aeb188161636e7eb78a1032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf5fe592d42c2c1ce8186005bd4727ce" id="r_gaaf5fe592d42c2c1ce8186005bd4727ce"><td class="memItemLeft" align="right" valign="top">static const float32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#gaaf5fe592d42c2c1ce8186005bd4727ce">COEFF_BANDPASS</a> [NUM_COEFF_HIGHPASS]</td></tr>
<tr class="separator:gaaf5fe592d42c2c1ce8186005bd4727ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89e51f5c593608b2deb597c865993e60" id="r_ga89e51f5c593608b2deb597c865993e60"><td class="memItemLeft" align="right" valign="top">static const float32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#ga89e51f5c593608b2deb597c865993e60">COEFF_DERFILT</a> [NUM_COEFF_DERFILT]</td></tr>
<tr class="separator:ga89e51f5c593608b2deb597c865993e60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00c285b355f2c44be9326901aceda6e9" id="r_ga00c285b355f2c44be9326901aceda6e9"><td class="memItemLeft" align="right" valign="top">static const float32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#ga00c285b355f2c44be9326901aceda6e9">COEFF_MOVAVG</a> [NUM_COEFF_MOVAVG]</td></tr>
<tr class="separator:ga00c285b355f2c44be9326901aceda6e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf8b1ef5a139506ea5871d6fc1186d270" id="r_gaf8b1ef5a139506ea5871d6fc1186d270"><td class="memItemLeft" align="right" valign="top"><a id="gaf8b1ef5a139506ea5871d6fc1186d270" name="gaf8b1ef5a139506ea5871d6fc1186d270"></a>
static float32_t&#160;</td><td class="memItemRight" valign="bottom"><b>stateBuffer_bandPass</b> [STATE_BUFF_SIZE_BANDPASS] = { 0 }</td></tr>
<tr class="separator:gaf8b1ef5a139506ea5871d6fc1186d270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00c97417289fb75c55a68a11bd15c214" id="r_ga00c97417289fb75c55a68a11bd15c214"><td class="memItemLeft" align="right" valign="top"><a id="ga00c97417289fb75c55a68a11bd15c214" name="ga00c97417289fb75c55a68a11bd15c214"></a>
static const IIR_Filt_t&#160;</td><td class="memItemRight" valign="bottom"><b>bandpassFiltStruct</b> = { NUM_STAGES_BANDPASS, stateBuffer_bandPass, COEFF_BANDPASS }</td></tr>
<tr class="separator:ga00c97417289fb75c55a68a11bd15c214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6ba4ee92fc40b1cf8ca2dba85f0c6fd2" id="r_ga6ba4ee92fc40b1cf8ca2dba85f0c6fd2"><td class="memItemLeft" align="right" valign="top"><a id="ga6ba4ee92fc40b1cf8ca2dba85f0c6fd2" name="ga6ba4ee92fc40b1cf8ca2dba85f0c6fd2"></a>
static const IIR_Filt_t *const&#160;</td><td class="memItemRight" valign="bottom"><b>bandpassFilter</b> = &amp;bandpassFiltStruct</td></tr>
<tr class="separator:ga6ba4ee92fc40b1cf8ca2dba85f0c6fd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f006095b4d56c8f6c37e00b1815364c" id="r_ga6f006095b4d56c8f6c37e00b1815364c"><td class="memItemLeft" align="right" valign="top"><a id="ga6f006095b4d56c8f6c37e00b1815364c" name="ga6f006095b4d56c8f6c37e00b1815364c"></a>
static float32_t&#160;</td><td class="memItemRight" valign="bottom"><b>stateBuffer_DerFilt</b> [STATE_BUFF_SIZE_DERFILT] = { 0 }</td></tr>
<tr class="separator:ga6f006095b4d56c8f6c37e00b1815364c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e14d893187762ee51abcc65bfc4995d" id="r_ga0e14d893187762ee51abcc65bfc4995d"><td class="memItemLeft" align="right" valign="top"><a id="ga0e14d893187762ee51abcc65bfc4995d" name="ga0e14d893187762ee51abcc65bfc4995d"></a>
static const FIR_Filt_t&#160;</td><td class="memItemRight" valign="bottom"><b>derivativeFiltStruct</b> = { NUM_COEFF_DERFILT, stateBuffer_DerFilt, COEFF_DERFILT }</td></tr>
<tr class="separator:ga0e14d893187762ee51abcc65bfc4995d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga746de8e4933cec58d016d15c60889720" id="r_ga746de8e4933cec58d016d15c60889720"><td class="memItemLeft" align="right" valign="top"><a id="ga746de8e4933cec58d016d15c60889720" name="ga746de8e4933cec58d016d15c60889720"></a>
static const FIR_Filt_t *const&#160;</td><td class="memItemRight" valign="bottom"><b>derivativeFilter</b> = &amp;derivativeFiltStruct</td></tr>
<tr class="separator:ga746de8e4933cec58d016d15c60889720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga72ce31948fa328359dcf375929ebf185" id="r_ga72ce31948fa328359dcf375929ebf185"><td class="memItemLeft" align="right" valign="top"><a id="ga72ce31948fa328359dcf375929ebf185" name="ga72ce31948fa328359dcf375929ebf185"></a>
static float32_t&#160;</td><td class="memItemRight" valign="bottom"><b>stateBuffer_MovingAvg</b> [STATE_BUFF_SIZE_MOVAVG] = { 0 }</td></tr>
<tr class="separator:ga72ce31948fa328359dcf375929ebf185"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab331ee8284225236dec1d4d2f042cc71" id="r_gab331ee8284225236dec1d4d2f042cc71"><td class="memItemLeft" align="right" valign="top"><a id="gab331ee8284225236dec1d4d2f042cc71" name="gab331ee8284225236dec1d4d2f042cc71"></a>
static const FIR_Filt_t&#160;</td><td class="memItemRight" valign="bottom"><b>movingAvgFiltStruct</b> = { NUM_COEFF_MOVAVG, stateBuffer_MovingAvg, COEFF_MOVAVG }</td></tr>
<tr class="separator:gab331ee8284225236dec1d4d2f042cc71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa663272fbf6747beab383a9fc4bd6cd0" id="r_gaa663272fbf6747beab383a9fc4bd6cd0"><td class="memItemLeft" align="right" valign="top"><a id="gaa663272fbf6747beab383a9fc4bd6cd0" name="gaa663272fbf6747beab383a9fc4bd6cd0"></a>
static const FIR_Filt_t *const&#160;</td><td class="memItemRight" valign="bottom"><b>movingAverageFilter</b> = &amp;movingAvgFiltStruct</td></tr>
<tr class="separator:gaa663272fbf6747beab383a9fc4bd6cd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Implementation</h2></td></tr>
<tr class="memitem:gaa2a304ae511c523eae57e1dd9337945b" id="r_gaa2a304ae511c523eae57e1dd9337945b"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#gaa2a304ae511c523eae57e1dd9337945b">QRS_findFiducialMarks</a> (const float32_t yn[], uint16_t fidMarkArray[])</td></tr>
<tr class="memdesc:gaa2a304ae511c523eae57e1dd9337945b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark local peaks in the input signal <code>y</code> as potential candidates for QRS complexes (AKA "fiducial marks").  <br /></td></tr>
<tr class="separator:gaa2a304ae511c523eae57e1dd9337945b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf8d42a9b040b0c2ccb2e0b0f9328a1e8" id="r_gaf8d42a9b040b0c2ccb2e0b0f9328a1e8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#gaf8d42a9b040b0c2ccb2e0b0f9328a1e8">QRS_initLevels</a> (const float32_t yn[], float32_t *sigLvlPtr, float32_t *noiseLvlPtr)</td></tr>
<tr class="memdesc:gaf8d42a9b040b0c2ccb2e0b0f9328a1e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the signal and noise levels for the QRS detector using the initial block of input signal data.  <br /></td></tr>
<tr class="separator:gaf8d42a9b040b0c2ccb2e0b0f9328a1e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f8ddd773a00840ebbbfb073193e1aa3" id="r_ga9f8ddd773a00840ebbbfb073193e1aa3"><td class="memItemLeft" align="right" valign="top">static float32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#ga9f8ddd773a00840ebbbfb073193e1aa3">QRS_updateLevel</a> (const float32_t peakAmplitude, float32_t level)</td></tr>
<tr class="memdesc:ga9f8ddd773a00840ebbbfb073193e1aa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the signal level (if a fiducial mark is a confirmed peak) or the noise level (if a fiducial mark is rejected).  <br /></td></tr>
<tr class="separator:ga9f8ddd773a00840ebbbfb073193e1aa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf2f697327fa1c76f94afca729bf9f30" id="r_gadf2f697327fa1c76f94afca729bf9f30"><td class="memItemLeft" align="right" valign="top">static float32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#gadf2f697327fa1c76f94afca729bf9f30">QRS_updateThreshold</a> (const float32_t <a class="el" href="_q_r_s_8c.html#a5802584806ac0a13e91c5d6c59d35a1d">signalLevel</a>, const float32_t <a class="el" href="_q_r_s_8c.html#a9eef3c7be031e34630901e275d9d55ff">noiseLevel</a>)</td></tr>
<tr class="memdesc:gadf2f697327fa1c76f94afca729bf9f30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the amplitude threshold used to identify peaks based on the signal and noise levels.  <br /></td></tr>
<tr class="separator:gadf2f697327fa1c76f94afca729bf9f30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Interface Functions</h2></td></tr>
<tr class="memitem:ga66b93594125ecb89623cf21c02ae6621" id="r_ga66b93594125ecb89623cf21c02ae6621"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#ga66b93594125ecb89623cf21c02ae6621">QRS_Init</a> (void)</td></tr>
<tr class="memdesc:ga66b93594125ecb89623cf21c02ae6621"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the QRS detector.  <br /></td></tr>
<tr class="separator:ga66b93594125ecb89623cf21c02ae6621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23e7aac4cbf3423df23afce8a43de44d" id="r_ga23e7aac4cbf3423df23afce8a43de44d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#ga23e7aac4cbf3423df23afce8a43de44d">QRS_Preprocess</a> (const float32_t xn[], float32_t yn[])</td></tr>
<tr class="memdesc:ga23e7aac4cbf3423df23afce8a43de44d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Preprocess the ECG data to remove noise and/or exaggerate the signal characteristic(s) of interest.  <br /></td></tr>
<tr class="separator:ga23e7aac4cbf3423df23afce8a43de44d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga189dec78669b6441ec04fc100f16b8fc" id="r_ga189dec78669b6441ec04fc100f16b8fc"><td class="memItemLeft" align="right" valign="top">float32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#ga189dec78669b6441ec04fc100f16b8fc">QRS_applyDecisionRules</a> (const float32_t yn[])</td></tr>
<tr class="memdesc:ga189dec78669b6441ec04fc100f16b8fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the average heart rate (HR) using predetermined decision rules.  <br /></td></tr>
<tr class="separator:ga189dec78669b6441ec04fc100f16b8fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5565e1314bc6a6f027d346b79603a668" id="r_ga5565e1314bc6a6f027d346b79603a668"><td class="memItemLeft" align="right" valign="top">float32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__qrs.html#ga5565e1314bc6a6f027d346b79603a668">QRS_runDetection</a> (const float32_t xn[], float32_t yn[])</td></tr>
<tr class="memdesc:ga5565e1314bc6a6f027d346b79603a668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the full algorithm (preprocessing and decision rules) on the inputted ECG data.  <br /></td></tr>
<tr class="separator:ga5565e1314bc6a6f027d346b79603a668"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Module for analyzing ECG data to determine heart rate. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa2a304ae511c523eae57e1dd9337945b" name="gaa2a304ae511c523eae57e1dd9337945b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa2a304ae511c523eae57e1dd9337945b">&#9670;&#160;</a></span>QRS_findFiducialMarks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t QRS_findFiducialMarks </td>
          <td>(</td>
          <td class="paramtype">const float32_t&#160;</td>
          <td class="paramname"><em>yn</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>fidMarkArray</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mark local peaks in the input signal <code>y</code> as potential candidates for QRS complexes (AKA "fiducial marks"). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">yn</td><td>Array containing the preprocessed ECG signal <img class="formulaInl" alt="$ y[n] $" src="form_20.png" width="21" height="14"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fidMarkArray</td><td>Array to place the fiducial mark's sample indices into. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numMarks</td><td>Number of identified fiducial marks</td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd><code>fidMarkArray</code> will hold the values of the fiducial marks. </dd></dl>
<p>The fiducial marks must be spaced apart by at least 200 [ms] (40 samples @ fs = 200 [Hz]). If a peak is found within this range, the one with the largest amplitude is taken to be the correct peak and the other is ignored.</p>

</div>
</div>
<a id="gaf8d42a9b040b0c2ccb2e0b0f9328a1e8" name="gaf8d42a9b040b0c2ccb2e0b0f9328a1e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf8d42a9b040b0c2ccb2e0b0f9328a1e8">&#9670;&#160;</a></span>QRS_initLevels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void QRS_initLevels </td>
          <td>(</td>
          <td class="paramtype">const float32_t&#160;</td>
          <td class="paramname"><em>yn</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float32_t *&#160;</td>
          <td class="paramname"><em>sigLvlPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float32_t *&#160;</td>
          <td class="paramname"><em>noiseLvlPtr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the signal and noise levels for the QRS detector using the initial block of input signal data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">yn</td><td>Array containing the preprocessed ECG signal <img class="formulaInl" alt="$ y[n] $" src="form_20.png" width="21" height="14"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigLvlPtr</td><td>Pointer to variable holding the signal level value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noiseLvlPtr</td><td>Pointer to variable holding the noise level value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd>The signal and noise levels are initialized. </dd></dl>

</div>
</div>
<a id="ga9f8ddd773a00840ebbbfb073193e1aa3" name="ga9f8ddd773a00840ebbbfb073193e1aa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f8ddd773a00840ebbbfb073193e1aa3">&#9670;&#160;</a></span>QRS_updateLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static float32_t QRS_updateLevel </td>
          <td>(</td>
          <td class="paramtype">const float32_t&#160;</td>
          <td class="paramname"><em>peakAmplitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float32_t&#160;</td>
          <td class="paramname"><em>level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the signal level (if a fiducial mark is a confirmed peak) or the noise level (if a fiducial mark is rejected). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">peakAmplitude</td><td>Amplitude of the fiducial mark in signal <img class="formulaInl" alt="$ y[n] $" src="form_20.png" width="21" height="14"/> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>The current value of the signal level or noise level </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">newLevel</td><td>The updated value of the signal level or noise level </td></tr>
  </table>
  </dd>
</dl>
<p><img class="formulaInl" alt="$
signalLevel_1    = f(peakAmplitude, signalLevel_0)
                 = \frac{1}{8}peakAmplitude + \frac{7}{8}signalLevel_0
$" src="form_23.png" width="461" height="16"/></p>
<p><img class="formulaInl" alt="$
noiseLevel_1     = f(peakAmplitude, noiseLevel_0)
                 = \frac{1}{8}peakAmplitude + \frac{7}{8}noiseLevel_0
$" src="form_24.png" width="446" height="16"/></p>

</div>
</div>
<a id="gadf2f697327fa1c76f94afca729bf9f30" name="gadf2f697327fa1c76f94afca729bf9f30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadf2f697327fa1c76f94afca729bf9f30">&#9670;&#160;</a></span>QRS_updateThreshold()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static float32_t QRS_updateThreshold </td>
          <td>(</td>
          <td class="paramtype">const float32_t&#160;</td>
          <td class="paramname"><em>signalLevel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float32_t&#160;</td>
          <td class="paramname"><em>noiseLevel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the amplitude threshold used to identify peaks based on the signal and noise levels. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">signalLevel</td><td>Current signal level. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noiseLevel</td><td>Current noise level. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">threshold</td><td>New threshold to use for next comparison.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__qrs.html#ga9f8ddd773a00840ebbbfb073193e1aa3" title="Update the signal level (if a fiducial mark is a confirmed peak) or the noise level (if a fiducial ma...">QRS_updateLevel()</a>, <a class="el" href="group__qrs.html#ga189dec78669b6441ec04fc100f16b8fc" title="Calculate the average heart rate (HR) using predetermined decision rules.">QRS_applyDecisionRules</a> </dd></dl>
<p><img class="formulaInl" alt="$
threshold = f(signalLevel, noiseLevel) = noiseLevel + 0.25(signalLevel - noiseLevel)
$" src="form_25.png" width="429" height="29"/></p>

</div>
</div>
<a id="ga66b93594125ecb89623cf21c02ae6621" name="ga66b93594125ecb89623cf21c02ae6621"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga66b93594125ecb89623cf21c02ae6621">&#9670;&#160;</a></span>QRS_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QRS_Init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the QRS detector. </p>
<dl class="section note"><dt>Note</dt><dd>This function isn't necessary anymore, but I'm keeping it here just in case. </dd></dl>
<p>This function originally initialized the filter <code>struct</code>s but now does nothing since those have been made <code>const</code> and their initialization functions have been removed entirely.</p>

</div>
</div>
<a id="ga23e7aac4cbf3423df23afce8a43de44d" name="ga23e7aac4cbf3423df23afce8a43de44d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga23e7aac4cbf3423df23afce8a43de44d">&#9670;&#160;</a></span>QRS_Preprocess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QRS_Preprocess </td>
          <td>(</td>
          <td class="paramtype">const float32_t&#160;</td>
          <td class="paramname"><em>xn</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float32_t&#160;</td>
          <td class="paramname"><em>yn</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Preprocess the ECG data to remove noise and/or exaggerate the signal characteristic(s) of interest. </p>
<dl class="section pre"><dt>Precondition</dt><dd>Fill input buffer <code>xn</code> with raw or lightly preprocessed ECG data.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xn</td><td>Array of raw ECG signal values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yn</td><td>Array used to store preprocessed ECG signal values.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd>The preprocessed signal data <img class="formulaInl" alt="$y[n]$" src="form_26.png" width="21" height="14"/> is stored in <code>yn</code> and is ready to be analyzed to calculate the heart rate in [bpm].</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__qrs.html#ga189dec78669b6441ec04fc100f16b8fc" title="Calculate the average heart rate (HR) using predetermined decision rules.">QRS_applyDecisionRules()</a> </dd></dl>
<p>This function uses the same overall preprocessing pipeline as the original Pan-Tompkins algorithm, but the high-pass and low-pass filters have been replaced with ones generated using Scipy.</p>
<p> </p>
<dl class="section note"><dt>Note</dt><dd>The FIR filters are applied in blocks to decrease the amount of memory needed for their state buffers.</dd></dl>

</div>
</div>
<a id="ga189dec78669b6441ec04fc100f16b8fc" name="ga189dec78669b6441ec04fc100f16b8fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga189dec78669b6441ec04fc100f16b8fc">&#9670;&#160;</a></span>QRS_applyDecisionRules()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float32_t QRS_applyDecisionRules </td>
          <td>(</td>
          <td class="paramtype">const float32_t&#160;</td>
          <td class="paramname"><em>yn</em>[]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the average heart rate (HR) using predetermined decision rules. </p>
<dl class="section pre"><dt>Precondition</dt><dd>Preprocess the raw ECG data.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">yn</td><td>Array of preprocessed ECG signal values. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">heartRate</td><td>Average heart rate in [bpm].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd>Certain information (signal/noise levels, thresholds, etc.) is retained between calls and used to improve further detection.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The current implementation only processes one block at a time and discards the data immediately after, so peaks that are cut off between one block and another might not be being counted.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__qrs.html#ga23e7aac4cbf3423df23afce8a43de44d" title="Preprocess the ECG data to remove noise and/or exaggerate the signal characteristic(s) of interest.">QRS_Preprocess()</a> </dd></dl>

</div>
</div>
<a id="ga5565e1314bc6a6f027d346b79603a668" name="ga5565e1314bc6a6f027d346b79603a668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5565e1314bc6a6f027d346b79603a668">&#9670;&#160;</a></span>QRS_runDetection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float32_t QRS_runDetection </td>
          <td>(</td>
          <td class="paramtype">const float32_t&#160;</td>
          <td class="paramname"><em>xn</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float32_t&#160;</td>
          <td class="paramname"><em>yn</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the full algorithm (preprocessing and decision rules) on the inputted ECG data. </p>
<p>This function simply combines the preprocessing and decision rules functions into a single function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xn</td><td>Array of raw ECG signal values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yn</td><td>Array used to hold preprocessed ECG signal values. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">heartRate</td><td>Average heart rate in [bpm].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd><code>yn</code> will contain the preprocessed data. </dd>
<dd>
Certain information (signal/noise levels, thresholds, etc.) is retained between calls.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__qrs.html#ga23e7aac4cbf3423df23afce8a43de44d" title="Preprocess the ECG data to remove noise and/or exaggerate the signal characteristic(s) of interest.">QRS_Preprocess()</a>, <a class="el" href="group__qrs.html#ga189dec78669b6441ec04fc100f16b8fc" title="Calculate the average heart rate (HR) using predetermined decision rules.">QRS_applyDecisionRules()</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="gaaf5fe592d42c2c1ce8186005bd4727ce" name="gaaf5fe592d42c2c1ce8186005bd4727ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf5fe592d42c2c1ce8186005bd4727ce">&#9670;&#160;</a></span>COEFF_BANDPASS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const float32_t COEFF_BANDPASS[NUM_COEFF_HIGHPASS]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    </div>
<div class="line">    0.002937758108600974f, 0.005875516217201948f, 0.002937758108600974f, </div>
<div class="line">    1.0485996007919312f, -0.2961403429508209f, </div>
<div class="line">    </div>
<div class="line">    1.0f, 2.0f, 1.0f, </div>
<div class="line">    1.3876197338104248f, -0.492422878742218f, </div>
<div class="line">    </div>
<div class="line">    1.0f, -2.0f, 1.0f, </div>
<div class="line">    1.3209134340286255f, -0.6327387690544128f, </div>
<div class="line">    </div>
<div class="line">    1.0f, -2.0f, 1.0f, </div>
<div class="line">    1.6299355030059814f, -0.7530401945114136f, </div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga89e51f5c593608b2deb597c865993e60" name="ga89e51f5c593608b2deb597c865993e60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89e51f5c593608b2deb597c865993e60">&#9670;&#160;</a></span>COEFF_DERFILT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const float32_t COEFF_DERFILT[NUM_COEFF_DERFILT]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    -0.125f, -0.25f, 0.0f, 0.25f, 0.125f</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga00c285b355f2c44be9326901aceda6e9" name="ga00c285b355f2c44be9326901aceda6e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga00c285b355f2c44be9326901aceda6e9">&#9670;&#160;</a></span>COEFF_MOVAVG</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const float32_t COEFF_MOVAVG[NUM_COEFF_MOVAVG]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    0.10000000149011612f, 0.10000000149011612f, 0.10000000149011612f, </div>
<div class="line">    0.10000000149011612f, 0.10000000149011612f, 0.10000000149011612f,</div>
<div class="line">    0.10000000149011612f, 0.10000000149011612f, 0.10000000149011612f, 0.10000000149011612f</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
